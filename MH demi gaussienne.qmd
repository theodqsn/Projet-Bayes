---
title: "MH"
format: html
editor: visual
---

## Quarto

Quarto enables you to weave together content and executable code into a finished document. To learn more about Quarto see <https://quarto.org>.

## Running Code

When you click the **Render** button a document will be generated that includes both content and the output of embedded code. You can embed code like this:

```{r}
1 + 1
```

You can add options to executable code like this

```{r}
#| echo: false
2 * 2
```

The `echo: false` option disables the printing of code (only output is displayed).

```{r}

g <- function(x,mu=0,std=10){
  if (x>=0){
    return(2*dnorm(x,sd=std))
  }
  else{
    return(0)
  }
}

mh_demi_gauss <- function(lambda1,sigma0=10^6,std_k,N,theta0){
  # On utilise un kernel gaussien
  log_theta <- log(theta0)
  lambda2 = c(1:N)
  i <- 0
  while (i < N){
    epsilon <- rnorm(n=1,mean=0,sd= std_k)
    log_prop <- log_theta +epsilon
    prop <- exp(log_prop)
    theta <- exp(log_theta)
    alpha <- prop * g(prop) / (theta * g(theta))
    u <- runif(n=1,0,1)
    if (u<=alpha){
      i <- i+1
      lambda2[i] <- (prop)+lambda1
      log_theta <- log_prop
    }
    
  }
  return(lambda2)
  
}
```

```{r}
y=mh_demi_gauss(0,sigma0=5,0.5,1000000,5)
```

```{r}
hist(y, probability = TRUE, breaks=200)
```
